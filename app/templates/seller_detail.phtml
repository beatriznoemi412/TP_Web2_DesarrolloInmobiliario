<?php require_once 'app/templates/layout/header.phtml'; ?>

<?php if (isset($seller)): ?>
<div class="container d-flex justify-content-center align-items-center" style="min-height: 100vh;">
    <div class="row">
        <div class="col-12 text-center">
            <h1 class="text-center text-light">Detalles del Vendedor</h1>
            <ul class="list-group">
                <li class="list-group-item bg-dark text-light">Nombre:
                    <?= isset($seller->Nombre) ? htmlspecialchars($seller->Nombre, ENT_QUOTES, 'UTF-8') : 'No disponible' ?></li>
                <li class="list-group-item bg-dark text-light">Apellido:
                    <?= isset($seller->Apellido) ? htmlspecialchars($seller->Apellido, ENT_QUOTES, 'UTF-8') : 'No disponible' ?></li>
                <li class="list-group-item bg-dark text-light">Teléfono:
                    <?= isset($seller->Telefono) ? htmlspecialchars($seller->Telefono, ENT_QUOTES, 'UTF-8') : 'No disponible' ?></li>
                <li class="list-group-item bg-dark text-light">Email:
                    <?= isset($seller->Email) ? htmlspecialchars($seller->Email, ENT_QUOTES, 'UTF-8') : 'No disponible' ?></li>
            </ul>

            <br>

            <!-- Verifica si el usuario es administrador -->
            <?php if (isset($_SESSION['ROL_VENDEDOR']) && $_SESSION['ROL_VENDEDOR'] === 'admin'): ?>
            <h3 class="text-light mt-4">Ventas realizadas por este vendedor:</h3>

            <?php if (isset($ventas) && is_array($ventas) && count($ventas) > 0): ?>
            <table class="table table-dark mt-3">
                <thead>
                    <tr>
                        <th>Inmueble</th>
                        <th>Fecha</th>
                        <th>Precio</th>
                    </tr>
                </thead>
                <tbody>
                    <?php foreach ($ventas as $venta): ?>
                    <tr>
                    <td><?= htmlspecialchars($venta->inmueble, ENT_QUOTES, 'UTF-8') ?></td>
                        <td><?= htmlspecialchars($venta->fecha_venta, ENT_QUOTES, 'UTF-8') ?></td>
                        <td><?= htmlspecialchars($venta->precio, ENT_QUOTES, 'UTF-8') ?></td>
                    </tr>
                    <?php endforeach; ?>
                </tbody>
            </table>
            <?php else: ?>
            <p class="text-light">Este vendedor no ha realizado ninguna venta.</p>
            <?php endif; ?>

            <?php else: ?>
            <p class="text-light">Solo los administradores pueden ver las ventas realizadas por este vendedor.</p>
            <?php endif; ?>

            <br>
            <a href="<?= 'listar/'; ?>" class="btn btn-primary">Volver a la lista</a>
        </div>
    </div>
</div>
<?php else: ?>
<div class="container">
    <h2 class="text-light">No se encontró información del vendedor.</h2>
    <a href="<?= 'listar/'; ?>" class="btn btn-primary">Volver a la lista</a>
</div>
<?php endif; ?>

<?php require_once 'app/templates/layout/footer.phtml'; ?>